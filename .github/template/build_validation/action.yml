name: build_validation

inputs:
  SONAR_TOKEN:
    required: true
  PROJECT_FOLDER:
    required: true
  PROJECT_KEY:
    required: true
  PROJECT_ORGANIZATION:
    required: true

runs:
  using: "composite"
  steps:
      # Checks out the repository this file is in
    - uses: actions/checkout@v3

    # - name: SonarCloud Scan
    #   uses: SonarSource/sonarcloud-github-action@master
    #   with:
    #     projectBaseDir: ${{ inputs.PROJECT_FOLDER }}
    #     args: >
    #       -Dsonar.organization=${{ inputs.PROJECT_ORGANIZATION }}
    #       -Dsonar.projectKey=${{ inputs.PROJECT_KEY }}
    #   env:
    #     # GITHUB_TOKEN: ${{ inputs.GITHUB_TOKEN }}  # Needed to get PR information, if any
    #     SONAR_TOKEN: ${{ inputs.SONAR_TOKEN }}
    - name: Install dependencies
      shell: bash
      run: |
        cd Src
        cd node
        ls

    - name: Install packages
      shell: bash
      run: npm install mocha chai supertest --save-dev
    
    - name: Install dependencies
      shell: bash
      run: npm install
    
    - name: Run Unit Test
      shell: bash
      run: npm test